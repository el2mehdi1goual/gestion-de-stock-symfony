{% extends 'base.html.twig' %}
{% block title %}Utilisateurs{% endblock %}
{% block page_title %}Utilisateurs{% endblock %}
{% block page_subtitle %}Gestion des employés{% endblock %}

{% block body %}
<div class="page-full">
  <div class="page-header">
    <h1><i class="fas fa-users"></i> Employés</h1>
    <a class="btn" href="{{ path('users_new') }}">➕ Ajouter</a>
  </div>

  {% for message in app.flashes('success') %}
    <div class="alert alert-success">{{ message }}</div>
  {% endfor %}
  {% for message in app.flashes('error') %}
    <div class="alert alert-danger">{{ message }}</div>
  {% endfor %}

  <div class="card table-card">
    <div class="table-scroll">
      <div class="table products">
        <div class="tr head">
          <div>#</div>
          <div>Nom</div>
          <div>Prénom</div>
          <div>Email</div>
          <div>Rôle</div>
          <div class="col-actions">Actions</div>
        </div>

        {% for u in users %}
          <div class="tr">
            <div class="muted">#{{ u.id }}</div>
            <div class="cell-title">{{ u.nom }}</div>
            <div>{{ u.prenom }}</div>
            <div>{{ u.email }}</div>
            <div><span class="badge badge-ok">Employé</span></div>

            <div class="actions-cell right">
              <a class="icon-btn edit" title="Modifier" href="{{ path('users_edit', {id: u.id}) }}"><i class="fas fa-edit"></i></a>
                <form class="inline js-delete-form" method="post"
                      action="{{ path('users_delete', {id: u.id}) }}"
                      data-confirm-message="Supprimer cet utilisateur ?">
                <input type="hidden" name="_token" value="{{ csrf_token('delete_user_' ~ u.id) }}">
                <button class="icon-btn delete" title="Supprimer"><i class="fas fa-trash"></i></button>
              </form>
            </div>
          </div>
        {% else %}
          <div class="empty">Aucun employé trouvé.</div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
